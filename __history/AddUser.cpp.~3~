//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "AddUser.h"
#include "AdminForm.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm6 *Form6;
//---------------------------------------------------------------------------
__fastcall TForm6::TForm6(TComponent* Owner)
	: TForm(Owner)
{
	FDQuery1->Connection = FDConnection1;
}
//---------------------------------------------------------------------------

void __fastcall TForm6::ButtonAddUserClick(TObject *Sender)
{

		FDQuery1->SQL->Text = "INSERT INTO Volunteers (name, email, phone) "
							  "VALUES (:name, :email, :phone)";
		FDQuery1->ParamByName("name")->AsString = EditName->Text;
		FDQuery1->ParamByName("email")->AsString = EditMail->Text;
		FDQuery1->ParamByName("phone")->AsString = EditNumber->Text;
		try {
			FDQuery1->ExecSQL();  // Виконати запит
			ShowMessage("Запит успішно додано!");
			TForm2 *AdminForm = new TForm2(this);
			AdminForm->Show();
			this->Close();
		}
		catch (Exception &e) {
			ShowMessage("Помилка при додаванні запиту: " + e.Message);
		}

}
//---------------------------------------------------------------------------

void __fastcall TForm6::Close1Click(TObject *Sender)
{
	Application->Terminate();
}
//---------------------------------------------------------------------------


